# UEMCP v1.1.0 Release Notes

**Release Date:** September 2025  
**Theme:** Reliability & Stability - Command Registration System Fixes

## üéâ Overview

UEMCP v1.1.0 is a critical reliability release that resolves fundamental command registration system failures discovered during comprehensive testing. This release transforms a partially-working system into a fully functional, robust foundation by eliminating "Unknown command" errors and fixing backend API compatibility issues.

The primary achievement of v1.1.0 is **restoring complete MCP command functionality** - from 56+ errors across the system down to zero errors, with all 22 MCP tools now working reliably. This release ensures that every MCP command properly reaches its intended Python implementation.

## ‚ú® Major Features

### üîß Complete Command Registration System Overhaul

**Error Reduction: 56+ errors ‚Üí 0 errors**

The centerpiece of v1.1.0 is a comprehensive fix to the broken command registration system that was preventing MCP tools from executing properly:

#### **Fixed Incomplete Command Mapping**
```python
# Previously missing critical command mappings
"asset_get_info": "asset_get_asset_info",
"material_create": "material_create_material", 
"material_info": "material_get_material_info",
"material_apply": "material_apply_material_to_actor",
"blueprint_create": "blueprint_create",
"blueprint_get_info": "blueprint_get_info",
"batch_spawn": "actor_batch_spawn",
"actor_snap_to_socket": "actor_snap_to_socket"
```

#### **New Flexible Parameter Validation**
```python
class OffsetRule(ValidationRule):
    """Validates offset parameter - accepts both dict {x,y,z} and list [x,y,z] formats."""
    
    def validate(self, value: Any, field_name: str) -> Optional[str]:
        # Handles both MCP dict format: {x: 0, y: 0, z: 0}
        # And legacy array format: [0, 0, 0]
```

#### **Backend API Compatibility Fixes**
```python
# Fixed deprecated Unreal Engine Python API calls
static_mesh = mesh_comp.static_mesh  # Was: mesh_comp.get_static_mesh()
sockets = getattr(static_mesh, 'sockets', None)  # Was: static_mesh.get_sockets()
```

### üß™ Enhanced Test Suite Reliability

**Test Success Rate: Variable ‚Üí 100% (9/9 tests passing)**

#### **Improved Error Detection**
```javascript
// Enhanced log analysis with proper baseline clearing
üßπ Clearing UE logs for clean test baseline...
‚úÖ UE log file cleared successfully
üîç Checking Unreal Engine logs for errors...
‚úÖ No errors found in UE logs
```

#### **Cleaner Connection Testing**
```javascript
// Removed unnecessary actor creation from connection tests
// Connection verification now focuses on communication, not functionality
‚úÖ Listener status check
‚úÖ Project information retrieval  
‚úÖ Asset listing verification
```

## üîß Technical Improvements

### **Command Dispatch Architecture**

#### **Robust Command Mapping System**
The command registration system now properly handles all MCP tool formats:

```python
# Comprehensive command mapping with multiple aliases
command_map = {
    # Direct MCP mappings
    "asset_get_info": "asset_get_asset_info",
    "batch_spawn": "actor_batch_spawn", 
    
    # Legacy format support
    "asset.info": "asset_get_asset_info",
    "actor.batch_spawn": "actor_batch_spawn",
    
    # Standalone function mappings
    "blueprint_create": "blueprint_create",
    "blueprint_get_info": "blueprint_get_info"
}
```

#### **Enhanced Parameter Format Flexibility**
```python
def _apply_offset_to_location(self, location, rotation, offset):
    """Apply offset to location in world space."""
    # Handle both dict format {x:0, y:0, z:0} and array format [0,0,0]
    if isinstance(offset, dict):
        offset_vector = unreal.Vector(
            offset.get("x", 0), 
            offset.get("y", 0), 
            offset.get("z", 0)
        )
    else:
        # Array format [x, y, z]
        offset_vector = unreal.Vector(offset[0], offset[1], offset[2])
```

### **Error Handling and Validation**

#### **Comprehensive Validation Rules**
```python
# New validation system supporting multiple parameter formats
@validate_inputs({
    "sourceActor": [RequiredRule(), TypeRule(str)],
    "targetActor": [RequiredRule(), TypeRule(str)], 
    "targetSocket": [RequiredRule(), TypeRule(str)],
    "offset": [OffsetRule()],  # Accepts both dict and array formats
    "validate": [TypeRule(bool)]
})
```

#### **API Compatibility Layer**
```python
# Fixed StaticMeshComponent API usage
try:
    # Use property access (UE 5.4+ compatible)
    static_mesh = mesh_comp.static_mesh
    sockets = getattr(static_mesh, 'sockets', None)
except AttributeError:
    # Fallback handling for edge cases
    log_error("StaticMesh component not properly configured")
```

## üêõ Bug Fixes

### **MCP Command Registration**
- **Fixed**: "Unknown command" errors for `asset_get_info`, `material_create`, `blueprint_create`, `batch_spawn`, and other core tools
- **Fixed**: Incomplete command mapping in `uemcp_listener.py` causing 50+ commands to fail
- **Fixed**: Command dispatch routing for standalone functions vs class methods

### **Parameter Validation System**  
- **Fixed**: `offset must be a list or tuple` errors when MCP tools send dict format `{x, y, z}`
- **Fixed**: Parameter format mismatches between MCP server and Python backend
- **Fixed**: Socket snapping validation rejecting valid dict-format offset parameters

### **Unreal Engine API Compatibility**
- **Fixed**: `StaticMeshComponent.get_static_mesh()` ‚Üí `static_mesh` property access (lines actor.py:1330)
- **Fixed**: `StaticMesh.get_sockets()` ‚Üí `sockets` property access (lines actor.py:1341, asset.py:267)
- **Fixed**: Invalid `EditorLevelLibrary.is_actor_valid()` call in batch spawn validation (actor.py:790)

### **Test Infrastructure**
- **Fixed**: Race conditions in restart_listener test validation
- **Fixed**: Test actors not being properly cleaned up after runs
- **Fixed**: Hardcoded project path (HomeEditor ‚Üí DemoEditor) in e2e test runner
- **Fixed**: Unnecessary actor creation in connection tests causing cleanup issues

## ‚ö†Ô∏è Breaking Changes

**None!** This release maintains full backward compatibility while fixing underlying system issues.

All existing MCP tool calls will continue to work exactly as before, but will now actually execute successfully instead of failing with "Unknown command" errors.

## üì¶ Installation

### **Server Installation**

```bash
# Clone the repository
git clone https://github.com/atomantic/UEMCP.git
cd UEMCP

# Install server dependencies
cd server
npm install

# Build TypeScript
npm run build
```

### **Plugin Installation**

```bash
# Copy plugin to your UE project
cp -r plugin/UEMCP /path/to/your/project/Plugins/

# Or create symbolic link for development
ln -s $(pwd)/plugin/UEMCP /path/to/your/project/Plugins/UEMCP
```

### **MCP Integration**

Add to your Claude Desktop configuration (`claude_desktop_config.json`):

```json
{
  "mcpServers": {
    "uemcp": {
      "command": "node",
      "args": ["/path/to/UEMCP/server/dist/index.js"],
      "env": {
        "UEMCP_PROJECT_PATH": "/path/to/your/unreal/project"
      }
    }
  }
}
```

## üîÑ Migration from v1.0.0

### **For Existing Users:**

**No action required!** Simply update to v1.1.0 and restart:

1. Pull the latest changes: `git pull origin main`
2. Restart Unreal Engine 
3. Restart Claude Desktop
4. Verify with: `npm test` - should show all tests passing

### **For Developers:**

If you've been working around "Unknown command" errors, you can now remove any workarounds:

```python
# BEFORE v1.1.0 (workarounds no longer needed)
# Using python_proxy for basic operations
await python_proxy({ code: "spawn_actor_code_here" })

# AFTER v1.1.0 (proper tools now work)
await actor_spawn({ assetPath: "/Game/Asset", location: [0,0,0] })
await material_apply({ actorName: "Wall", materialPath: "/Game/Material" })
await blueprint_create({ className: "BP_Door", parentClass: "Actor" })
```

## üìö Documentation Updates

### **Updated Documentation**
- **RELEASE_PROCESS.md**: Enhanced version numbering and quality checklist procedures
- **CLAUDE.md**: Updated exception handling philosophy and validation patterns
- **Test Infrastructure**: Improved error detection and baseline clearing procedures

### **Bug Fix Documentation**
- **Command Registration**: Complete mapping of MCP tools to Python implementations
- **Parameter Validation**: Documentation of flexible offset parameter formats
- **API Compatibility**: Guidelines for UE 5.4+ Python API usage patterns

## üöÄ What's Next

### **Version 1.2.0 - Enhanced Development Experience (Planned)**

Building on the stability foundation of v1.1.0, the next release will focus on developer experience:

#### **Planned Features:**
- **Hot Reload System**: Faster Python code iteration without UE restarts
- **Enhanced Debugging**: Better error messages and diagnostic information
- **Performance Optimization**: Reduced command execution latency
- **Documentation Expansion**: More examples and use cases

#### **Tool Coverage Expansion:**
- **Level Design Tools**: Advanced scene composition and management
- **Asset Pipeline**: Improved import/export workflow automation  
- **Blueprint Enhancement**: Extended visual scripting capabilities

### **Version 1.3.0 - Advanced Integration (Future)**

#### **Potential Features:**
- **Multi-Project Support**: Manage multiple UE projects simultaneously
- **Advanced Analytics**: Usage metrics and performance monitoring
- **Extended Plugin Ecosystem**: Third-party tool integration framework

## üìä Statistics

### **Error Resolution**
- **Before v1.1.0**: 56+ "Unknown command" errors across test suite
- **After v1.1.0**: 0 errors, 100% command success rate
- **Test Success Rate**: 0/9 ‚Üí 9/9 tests passing consistently
- **UE Log Errors**: Multiple pages ‚Üí Clean logs with zero errors

### **Code Quality Improvements**
- **Command Mapping Coverage**: 12 commands ‚Üí 22+ commands properly mapped
- **Parameter Validation**: Single format ‚Üí Flexible dual-format support (dict + array)
- **API Compatibility**: 3 deprecated API calls fixed across actor.py and asset.py

### **MCP Tool Ecosystem**
- **Total Tools**: 22 MCP tools across 5 categories
- **Working Tools**: 12 ‚Üí 22 (100% functionality restored)
- **Core Categories**: Project Management, Actor Control, Viewport, Materials, Blueprints
- **Advanced Features**: Socket snapping, batch operations, placement validation

### **Testing Infrastructure** 
- **Unit Tests**: 1 passed (TypeScript compilation)
- **Integration Tests**: 4 passed (MCP + Python Bridge)  
- **E2E Tests**: 4 passed (Full UE + Demo Project)
- **Total Test Suite**: 9/9 passing with zero errors

---

**Full Changelog**: https://github.com/atomantic/UEMCP/compare/v1.0.0...v1.1.0